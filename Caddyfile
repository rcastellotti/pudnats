# Replace with your real domain or server IP.
# Example:
# pudnats.example.com {
#   import pudnats_common
# }

:80 {
	import pudnats_common
}

(pudnats_common) {
	encode zstd gzip

	# API traffic
	handle /api/* {
		reverse_proxy 127.0.0.1:9173 {
			header_up X-Forwarded-Proto {scheme}
			header_up X-Forwarded-Host {host}
			header_up X-Real-IP {remote_host}
		}
	}

	# Everything else goes to UI server
	handle {
		reverse_proxy 127.0.0.1:9172 {
			header_up X-Forwarded-Proto {scheme}
			header_up X-Forwarded-Host {host}
			header_up X-Real-IP {remote_host}
		}
	}

	log {
		output stdout
		format console
	}
}
